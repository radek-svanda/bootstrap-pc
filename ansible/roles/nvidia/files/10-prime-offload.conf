## FILE GENERATED BY XPS-TWEAKS INSTALL SCRIPT ##

# Define XServer with flags to enable NVIDIA offload sink
# and specify the Intel GPU as the primary output source
Section "ServerLayout"
    Identifier     "Layout0"
    Option         "AllowNVIDIAGPUScreens"
    Screen      0  "iGPU" 0 0
EndSection

# Some NVIDIA driver versions complain about this flag being unset
Section "ServerFlags"
    Option         "IgnoreABI" "1"
EndSection

# Define the Intel GPU
Section "Device"
    Identifier     "iGPU"
    Driver         "modesetting"
    BusID          "PCI:0:2:0"
EndSection

# Same as above but for the NVIDIA GPU
Section "Device"
    Identifier     "dGPU"
    Driver         "nvidia"
    BusID          "PCI:1:0:0"
EndSection

# Tell XServer that the Intel GPU is going to drive all connected Displays
Section "Screen"
    Identifier     "iGPU"
    Device         "iGPU"
    DefaultDepth    24
    SubSection     "Display"
		Viewport    0 0
    EndSubSection
EndSection

# Create modesetting output sink
Section "OutputClass"
    Identifier "iGPU"
    MatchDriver "i915"
    Driver "modesetting"
EndSection

# Create NVIDIA output sink
Section "OutputClass"
    Identifier "dGPU"
    MatchDriver "nvidia-drm"
    Driver "nvidia"
    Option "AllowEmptyInitialConfiguration"
    Option "PrimaryGPU" "yes"
    ModulePath "/usr/lib/nvidia/xorg"
    ModulePath "/usr/lib/xorg/modules"
EndSection